# nanoBlog

### Окно аутентификации в админ-панели и механизм его работы:

* Пользователь заходит на /admin/index.php, вводит логин и пароль.
* Пароль хешируется (простой ф-ей на JS, надо заменить на что-то более серьезное)
* Хеш вместе с логином преобразуется в JSON строку и через Ajax отправляется на обработчик - loginchecker.php.
* Обработчик сверяется с базой, формирует ответ в виде JSON строки, и отправляет его браузеру.
* Если ответ положительный, сервер также отправляет адрес перехода (adminview.php). JS в окне браузера находясь на странице index.php
инициирует переход на страницу adminview.php. После перехода на которую первым делом проверяется чтобы $_SESSION['role'] == 'admin', и если это не так,
пользователь перебрасывается обратно на index.php.
* Если ответ отрицательный (не аторизировано) в браузер просто отправляется этот отрицательный ответ, на основе которого JavaScript встряхивает
окно логина, сбрасывает логин/пароль тем самым намекая попробовать еще раз.

### Редактор записи/статьи

В редакторе можно вводить заголовок, тело записи, выбирать категорию (список загружается с БД при формировании страницы на сервере),
выбирать статус - опубликовано/черновик. **Редактор реализует главную мечту блоггера - никогда не терять несохраненный текст,
что бы ни случилось**. Если пользователь забыл указать какой-либо обязательный компонент записи (а именно **заголовок**, **категорию**, **тело записи**), весь его введенный текст не будет потерян! Сохранение черновика реализовано через массив $_SESSIONS,
и при какой-либо пользовательской ошибке обработчик (postController.php) сообщает текст ошибки, и возвращает назад через $_SESSION всю введенную
пользователем информацию. Чтобы удалить черновик (если он не нужен), пользователь должен явно указать это щелкнув соответствующую ссылку/кнопку.

Кроме создания новых записей, можно редактировать уже существующие.

Одним словом из CRUD реализовано CRU.

К записи можно добавлять ключевые слова, разделяемые запятой. Регулярное выражение на стороне сервера проверяет строку ключевых слов на базовый синтаксис
(чтоб были разделены запятой, не содержали левых символов, и чтоб не начинались и не заканчивались на запятую) и в случае несоответствия шаблону
возвращает пользователю введенную строку, с соответствующим сообщением об ошибке.

Также, к записи можно добавлять картинку. Для картинки при успешной загрузке **генерируется иконка**. При запросе на редактирование записи к которой прикреплена
картинка, выводится уведомление, что картинка у этой записи уже есть, но при желании пользователь может заменить ее другой, просто загрузив новую картинку.

### Пагинация
Пагинация пока реализована обычная (без плавно появляющегося центрального блока), но функциональная.
Также, постраничная разбивка выводит заголовки сохраненных записей разным цветом - зеленые опубликованы, красные - нет (в админке).

### обнаруженные баги
**[OPEN]** Список категорий **в админке** выводится циклом for. Эта конструкция может сломаться, если какая-то категория будет удалена, поскольку for
ожидает индексированный массив. Заменить на foreach. На представлениях которые видит пользователь этого бага уже нет (использован foreach).  